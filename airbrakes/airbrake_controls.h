#pragma once
#include <cstdint>
#include <vector>

inline const std::vector vel_ideal = {
  583.500018592, 577.168536805215, 570.870909354003, 564.606263815786, 558.373737411251, 552.172487133722,
  546.001698511375, 539.860593107501, 533.748434857031, 527.664535330992, 521.608258014579, 515.579021679001,
  509.576302922177, 503.599637948745, 497.648623655566, 491.722918085003, 485.822240304697, 479.946369769204,
  474.095145215863, 468.268463144357, 462.466275926826, 456.688589592852, 450.935461331292, 445.206996748659,
  439.503346921605, 433.824705278962, 428.171304346759, 422.543412387668, 416.941329964389, 411.365386454576,
  405.815936543044, 400.293356715136, 394.79804177332, 389.330401397294, 383.890856766106, 378.479837259071,
  373.097777250558, 367.745113012077, 362.422279733468, 357.129708673429, 351.867824448108, 346.637042465018,
  341.437766508152, 336.270386478837, 331.135276295591, 326.032791955087, 320.963269755198, 315.927024680046,
  310.924348946061, 305.955510707137, 301.020752916188, 296.120292339704, 291.254318721228, 286.422994089154,
  281.626452203706, 276.864798137594, 272.138107984439, 267.446428688818, 262.789777991534, 258.16814448355603,
  253.581487761981, 249.029738681293, 244.512799693193, 240.030545268307, 235.582822393145, 231.169451135782,
  226.790225273883, 222.444912978831, 218.133257549919, 213.854978192758, 209.609770836257, 205.406053354564,
  201.2425443122, 197.118002127934, 193.031223296488, 188.981040698708, 184.966321994936, 180.985968096607,
  177.038911711499, 173.124115958287, 169.240573046403, 165.387303017412, 161.563352544371, 157.767793785882,
  153.999723291714, 150.258260957108, 146.542549023014, 142.851751119705, 139.185051351365, 135.541653419366,
  131.920779782123, 128.321670849492, 124.743584209848, 121.185793888035, 117.647589632515, 114.128276230129,
  110.627172846956, 107.143612393867, 103.676940915414, 100.2265170007986, 96.7917112156951, 93.3719055538077,
  89.966492907058, 86.5748765533835, 83.1964696611631, 79.8306948093388, 76.476983522346, 73.1347758190052,
  69.8035197745682, 66.4826710951463, 63.1716927037836, 59.8700543374676, 56.5772321544001, 53.2927083508781,
  50.0159707871593, 46.7465126217111, 43.4838319532623, 40.2274314700984, 36.9768181060582, 33.731502702708596,
  30.4909996771875, 27.2548266952213, 24.022504348835, 20.7935558382854, 17.567506657758003, 14.3438842843778,
  11.1222178700919, 7.90203793599065, 4.68287606863716, 1.46426461798319
};

inline const std::vector alt_ideal = {
  818.000026176000, 876.100028035200, 933.566881715722, 990.403972651122, 1046.61459903270, 1102.20197277383,
  1157.16922148720, 1211.51939133834, 1265.25545064909, 1318.38029413479, 1370.89674766789, 1422.80757346935,
  1474.11547563725, 1524.82310592946, 1574.93306972434, 1624.44793208989, 1673.37022389840, 1721.70244792886,
  1769.44708490579, 1816.60659942737, 1863.18344574181, 1909.18007333449, 1954.59893229377, 1999.44247842690,
  2043.71317810177, 2087.41351279393, 2130.54598332183, 2173.11311375650, 2215.11745499527, 2256.56158799171,
  2297.44812663717, 2337.77972029147, 2377.55905596298, 2416.78886014032, 2455.47190028005, 2493.61098595666,
  2531.20896968256, 2568.26874740762, 2604.79325870883, 2640.78548668217, 2676.24845754952, 2711.18523999433,
  2745.59894424083, 2779.49272089164, 2812.86975953953, 2845.73328716909, 2878.08656636460, 2909.93289334012,
  2941.27559580812, 2972.11803070273, 3002.46358177344, 3032.31565706506, 3061.67768629903, 3090.55311817115,
  3118.94541758007, 3146.85806280044, 3174.29454261420, 3201.25835341264, 3227.75299628152, 3253.78197408068,
  3279.34878852903, 3304.45693730523, 3329.10991117336, 3353.31119114268, 3377.06424566951, 3400.37252790882,
  3423.23947302240, 3445.66849554979, 3467.66298684767, 3489.22631260267, 3510.36181042194, 3531.07278750557,
  3551.36339284102, 3571.23764727224, 3590.69944748504, 3609.75256981468, 3628.40067388456, 3646.64730608405,
  3664.49590289371, 3681.94979406486, 3699.01220566069, 3715.68626296533, 3731.97499326707, 3747.88132852151,
  3763.40810790010, 3778.55808022927, 3793.33390632498, 3807.73816122728, 3821.77333633925, 3835.44184147439,
  3848.74600681632, 3861.68808479454, 3874.27025187948, 3886.49461030047, 3898.36318968927, 3909.87794865252,
  3921.04077627554, 3931.85349356023, 3942.31785479962, 3952.43554889116, 3962.20820059124, 3971.63737171281,
  3980.72456226819, 3989.47121155890, 3997.87869921424, 4005.94834618035, 4013.68141566129, 4021.07911401352,
  4028.14259159542, 4034.87294357288, 4041.27121068239, 4047.33837995277, 4053.07538538652, 4058.48310860196,
  4063.56237943705, 4068.31397651576, 4072.73862777793, 4076.83701097326, 4080.60975412027, 4084.05743593088,
  4087.18058620115, 4089.97968616887, 4092.45516883839, 4094.60741927327, 4096.43677485710, 4097.94352552288,
  4099.12791395131, 4099.99013573832, 4100.53033953192, 4100.74862713879
};

double calculate_airbrake_target_angle(double current_pressure, double prev_pressure,
                                    double ground_pressure, double ground_temperature, double dt);

[[nodiscard]] int32_t encoder_pos_from_angle(double angle);
[[nodiscard]] double angle_from_encoder_pos(int32_t encoderPos);

void airbrakes_open();
void airbrakes_close();
void airbrakes_freeze();
